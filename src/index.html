<!DOCTYPE html>
<!--
  Copyright (c) 2018-2019 GraphDefined GmbH <achim.friedland@graphdefined.com>
  This file is part of Chargy Desktop App <https://github.com/OpenChargingCloud/ChargyDesktopApp>
 
  Licensed under the Affero GPL license, Version 3.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
 
      http://www.gnu.org/licenses/agpl.html
 
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<html>
  
  <head>
	  <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Chargy - Transparenzsoftware für die Elektromobilität</title>

    <meta name="description" content="Transparenzsoftware für die Elektromobilität">
    <meta name="author"      content="achim.friedland@graphdefined.com">
    <meta name="viewport"    content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https://updates.chargy.charging.cloud https://raw.githubusercontent.com/OpenChargingCloud/ChargyDesktopApp/master/; img-src 'self' data: https:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">

    <!--<link rel="icon"       href="/favicon.png"                 type="image/png" />-->
    <link rel="stylesheet" href="css/fontawesome-all.min.css"            type="text/css" />
    <link rel="stylesheet" href="js/leaflet/leaflet.css"                 type="text/css" />
    <link rel="stylesheet" href="js/leaflet/leaflet.awesome-markers.css" type="text/css" />
    <link rel="stylesheet" href="css/chargy.css"                         type="text/css" />

    <script type="text/javascript" src="js/leaflet/leaflet.js"></script>
    <script type="text/javascript" src="js/leaflet/leaflet.awesome-markers.js"></script>
    <script type="text/javascript" src="js/chargyInterfaces.js"></script>
    <script type="text/javascript" src="js/chargyLib.js"></script>
    <script type="text/javascript" src="js/ACrypt.js"></script>
    <script type="text/javascript" src="js/GDFCrypt01.js"></script>
    <script type="text/javascript" src="js/EMHCrypt01.js"></script>
    <script type="text/javascript" src="js/chargy.js"></script>

  </head>

  <body>

    <div id="headline">
        <div id="logo"></div>
        <div id="windowButtons">
            <button id="updateAvailableButton"                 ><i class="fas fa-exclamation-circle"></i></button>
            <button id="aboutButton"                           ><i class="far fa-question-circle"   ></i></button>
            <button id="fullScreenButton"                      ><i class="fas fa-expand"            ></i></button>
            <button id="appQuitButton" onclick="window.close()"><i class="fas fa-times"             ></i></button>
        </div>
    </div>

    <div id="verifyframe">

        <div id="leftbar">

            <div id="input">
                
                <div id="inputInfos">

                    <div id="text">Sie können den Transparenzdatensatz zu Ihren Ladevorgängen entweder aus
                                    einer Datei laden, über die Zwischenablage einfügen oder Drap'n'Drop
                                    verwenden...</div>

                    <div id="buttonsDiv">
                        <button id="fileInputButton"><i class="far fa-folder-open"></i><br />Datensatz<br />laden</button>
                        <input id="fileInput" type="file" style="display: none"/>
                        <button id="pasteButton"><i class="fas fa-paste"></i><br />Datensatz<br />einfügen</button>
                    </div>

                    <div id="loadingErrors">
                        <div id="errorText"></div>
                    </div>

                </div>

                <div id="aboutScreen">

                    <div id="softwareInfos">
                        <div id="product">
                            Chargy Transparenzsoftware - chargeIT mobility Edition v1.0.0
                        </div>
                        <div id="copyright">
                            &copy; 2018-2019 chargeIT mobility GmbH
                        </div>
                    </div>

                    <p>
                        Diese Software ist Open Source und basiert auf den folgenden Open-Source-Software-Bibliotheken:
                    </p>
                
                    <div id="OpenSourceLibs">
                        <div class="lib">
                            <div class="name">Chargy <script>document.write(require('electron').remote.app.getVersion())</script></div>
                            <div class="license"><button class="linkButton" href="https://github.com/OpenChargingCloud/ChargyDesktopApp/blob/master/LICENSE">Copyright &copy; 2018-2019 GraphDefined GmbH<br />AGPL v3 License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">Electron <script>document.write(process.versions.electron)</script></div>
                            <div class="license"><button class="linkButton" href="https://github.com/electron/electron/blob/master/LICENSE">Copyright &copy; 2013-2019 GitHub Inc.<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">Electron Builder 20.41.0</div>
                            <div class="license"><button class="linkButton" href="https://github.com/electron-userland/electron-builder/blob/master/LICENSE">Copyright &copy; 2015 Loopline Systems<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">Chromium <script>document.write(process.versions.chrome)</script></div>
                            <div class="license"><button class="linkButton" href="https://github.com/chromium/chromium/blob/master/LICENSE">Copyright &copy; 2015 The Chromium Authors<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">Node.js <script>document.write(process.versions.node)</script></div>
                            <div class="license"><button class="linkButton" href="https://github.com/nodejs/node/blob/master/LICENSE">Copyright &copy; Node.js contributors<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">OpenSSL <script>document.write(process.versions.openssl)</script></div>
                            <div class="license"><button class="linkButton" href="https://github.com/openssl/openssl/blob/master/LICENSE">Copyright &copy; 1998-2018 The OpenSSL Project<br />Copyright &copy; 1995-1998 Eric A. Young, Tim J. Hudson<br />Apache License v2.0</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">TypeScript 3.5.1</div>
                            <div class="license"><button class="linkButton" href="https://github.com/microsoft/TypeScript/blob/master/LICENSE.txt">Copyright &copy; Microsoft Corporation<br />Apache License v2.0</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">elliptic 6.4.1</div>
                            <div class="license"><button class="linkButton" href="https://github.com/indutny/elliptic">Copyright &copy; Fedor Indutny, 2014<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">moment 2.24.0</div>
                            <div class="license"><button class="linkButton" href="https://github.com/moment/moment/blob/develop/LICENSE">Copyright &copy; JS Foundation and other contributors<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">leaflet 1.4.0</div>
                            <div class="license"><button class="linkButton" href="https://github.com/Leaflet/Leaflet/blob/master/LICENSE">Copyright &copy; 2010-2018, Vladimir Agafonkin<br />Copyright &copy; 2010-2011, CloudMade<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">chart.js 2.8.0</div>
                            <div class="license"><button class="linkButton" href="https://github.com/chartjs/Chart.js/blob/master/LICENSE.md">Copyright &copy; 2018 Chart.js Contributors<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">SASS 1.20.3</div>
                            <div class="license"><button class="linkButton" href="https://github.com/sass/dart-sass/blob/master/LICENSE">Copyright &copy; 2016, Google Inc.<br />MIT License</button></div>
                        </div>
                        <div class="lib">
                            <div class="name">FontAwesome 5.9.0</div>
                            <div class="license"><button class="linkButton" href="https://fontawesome.com/license/free">Copyright &copy; Fonticons, Inc.<br />Font Awesome Free License</button></div>
                        </div>
                    </div>

                    <p>
                        Die SHA256/512-Hash-Funktionen werden durch die <button class="linkButton" href="https://nodejs.org/api/crypto.html">Node.js Crypto API</button> realisiert. Diese nutzen intern die <button class="linkButton" href="https://github.com/openssl/openssl">OpenSSL-Bibliothek</button> des jeweils aktuellen Node.js-Frameworks.
                    </p>
                    <p>
                        Elliptische Kurven Kryptographie wird durch <button class="linkButton" href="https://github.com/indutny/elliptic">elliptic</button> realisiert.
                        Hierbei kommen je nach Verfahren und Ladestations- bzw. Smart-Meter-Hersteller unterschiedliche elliptische Kurven zum Einsatz.
                    </p>
                    <p>
                        Weitere Details zu den internen Datenstrukturen und Abläufen von Chargy gibt es auf <button class="linkButton" href="https://github.com/OpenChargingCloud/ChargyDesktopApp/tree/master/documentation">GitHub</button>.
                    </p>

                    <div id="chargySHA512">
                        <div id="text">SHA-512 Hashwert dieser Software:</div>
                        <div id="value"><span stlye=\"font-style: italics\">Wird berechnet...</span></div>
                    </div>

                    <div id="chargySignature">
                        <div id="text">Digitale Signatur dieser Software:</div>
                        <div id="value"><span stlye=\"font-style: italics\">Wird berechnet...</span></div>
                        <div id="signer"></div>
                        <div id="signatureOk"></div>
                    </div>

                    <div id="TOSP">
                        Diese Software ist einer der Gewinner des <a href="javascript:OpenLink('https://www.it-leistungsschau.de/programm/TOSP2019/')">1.
                        Th&uuml;ringer Open Source Preises</a> im März 2019. Der Preis wurde verliehen durch
                        <a href="javascript:OpenLink('https://www.itnet-th.de')">ITnet Thüringen e.V.</a> and the
                        <a href="javascript:OpenLink('https://www.thueringen.de/th6/tmwwdg/')">Thüringer Ministerium für Wirtschaft, Wissenschaft und Digitale Gesellschaft</a>
                        <!-- This software is one of the winners of the <a href="javascript:OpenLink('https://www.it-leistungsschau.de/programm/TOSP2019/')">1st
                        Thuringian Open Source Prize</a> in March 2019. The prize was awarded by
                        <a href="javascript:OpenLink('https://www.itnet-th.de')">ITnet Thüringen e.V.</a> and the
                        <a href="javascript:OpenLink('https://www.thueringen.de/th6/tmwwdg/')">Thuringian Ministry for Economic Affairs, Science and Digital Society</a>-->
                        <div id="logos">
                            <a id="TMWWDG" href="javascript:OpenLink('https://www.thueringen.de/th6/tmwwdg/')"><img src="images/TMWWDG.svg"                 alt="Thuringian Ministry for Economic Affairs, Science and Digital Society"></a>
                            <a id="ITnet"  href="javascript:OpenLink('https://www.itnet.de')"                 ><img src="images/ITnet_Thueringen_small.png" alt="ITnet Thüringen e.V."></a>
                        </div>
                    </div>

                </div>

                <div id="updateAvailableScreen">

                    <p>
                        Ein Update für diese Software ist verfügbar...
                    </p>

                    <div id="versions"></div>

                </div>

                <div id="chargingSessionScreen"></div>

                <div id="backButtonDiv">
                    <button id="backButton"><i class="fas fa-arrow-alt-circle-left"></i></button>
                </div>

            </div>

        </div>

        <div id="rightbar">

            <div id="map"></div>

            <div id="evseTarifInfos">
            </div>

            <div id="feedback">
                Falsche Daten, falsche Signaturen oder sonstige Fragen?<br />
                Treten Sie mit uns in Kontakt:
                <div id="feedbackMethods">
                    <button id="showIssueTracker"><i class="far fa-comments"></i>Mängel melden</button>
                    <a      id="eMail" href="mailto:info@chargeIT-mobility.com?subject=Chargy%20Support%20Anfrage"><i class="far fa-envelope"></i>info@chargeIT-mobility.com</a>
                    <div    id="phone"><i class="fas fa-phone fa-rotate-90"></i>+49 (0) 9321 2680 700</div>
                    <!-- <a      id="github" href="javascript:OpenExternal('https://github.com/chargeITmobility/Transparenzsoftware')"><i class="fab fa-github"></i>Chargy Open Source Repository</a> -->
                </div>
            </div>

        </div>

        <div id="clear" style="clear:both;"></div>

    </div>

    <div id="overlay" style="display: none">
        <div id="overlayText">

            <div id="intro">
                Folgende Daten des Ladevorgangs sind <span class="important">mess- und eichrechtsrelevant</span> und damit gemäß <span id="cryptoAlgorithm"></span> Teil der digitalen Signatur:
            </div>

            <div id="cryptoData"></div>

            <div id="buffer" class="infoblock">
                <div class="description">Puffer</div>
                <div class="value">0x0000000000000000000000000000000000000000000000000000000000000000</div>
            </div>

            <div id="hashedBuffer" class="infoblock">
                <div class="description">Hashed Puffer (SHA512)</div>
                <div class="value">0x0000000000000000000000000000000000000000000000000000000000000000</div>
            </div>

            <div id="publicKey" class="infoblock">
                <div class="description">Public Key</div>
                <div class="value">0x0000000000000000000000000000000000000000000000000000000000000000</div>
            </div>

            <div id="signatureExpected" class="infoblock">
                <div class="description">Erwartete Signatur</div>
                <div class="value">0x0000000000000000000000000000000000000000000000000000000000000000</div>
            </div>

            <div id="signatureCheck"></div>

            <div id="overlayOkButtonDiv">
                <button id="overlayOkButton"><i class="fas fa-arrow-alt-circle-left"></i></button>
            </div>

        </div>
    </div>

    <div id="issueTracker" style="display: none">
        <div id="issueTrackerText">

            <div id="headline">
                Einen oder mehrere Mängel melden...
            </div>

            <form id="newIssue">

                <div class="label">Bitte wählen sie eine oder mehrere Kategorien...</div>
                <input type="checkbox" name="category" value="invalidCTR"> Transparenzdatensatz konnte nicht geladen werden<br>
                <input type="checkbox" name="category" value="invalidSignatures"> Signatur(en) im Transparenzdatensatz sind ungültig<br>
                <input type="checkbox" name="category" value="InvalidStationData"> Falsche Daten zu einer Ladestation<br>
                <input type="checkbox" name="category" value="InvalidStationData"> Fehler in der Transparenzsoftware<br>
                <input type="checkbox" name="category" value="other"> Sonstiges Problem<br>

                <div class="label">Bitte beschreiben Sie die Fehler oder Probleme ein wenig genauer...</div>
                <textarea id="description"></textarea>

                <div class="label">Ihre Kontaktdaten, falls Rückfragen notwendig sein sollten...</div>
                <input type="text" id="name"  placeholder="Ihr Name"><br /> 
                <input type="text" id="phone" placeholder="Ihre Telefonnummer"><br /> 
                <input type="text" id="email" placeholder="Ihre E-Mail Adresse"><br /> 

                <div id="sendIssueBox">
                    <input type="checkbox" name="acceptsPrivacy"> Datenschutzerklärung akzeptiert?<br />
                    <button id="sendIssue">Mängel melden</button>
                </div>

            </form>

            <div id="issueBackButtonDiv">
                <button id="issueBackButton"><i class="fas fa-arrow-alt-circle-left"></i></button>
            </div>

        </div>
    </div>

    <script type="text/javascript">

      // You can also require other files to run in this process
      require('./renderer.js')

      var ACCESS_TOKEN = "pk.eyJ1IjoiYWh6ZiIsImEiOiJOdEQtTkcwIn0.Cn0iGqUYyA6KPS8iVjN68w";

      leaflet = L;
      map     = L.map('map').setView([49.7325504,10.1424442], 10);

      L.tileLayer('https://{s}.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=' + ACCESS_TOKEN, {
          maxZoom: 18,
          attribution: '<a href="http://openstreetmap.org">OSM</a> contr., ' +
          '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
          'Imagery © <a href="http://mapbox.com">Mapbox</a>',
          id: 'ahzf.nc811hb2'
      }).addTo(map);

      var chargyApplication = new StartChargyApplication();

    </script>

  </body>

</html>
